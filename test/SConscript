import os.path
from SConfig import *
Import('environment')

testSources = ['main.cpp','gtest/gtest-all.cc']

libPath = '#' + os.path.join(BUILD_DIR, DEBUG_CONFIG)
test = environment.Program(target = TEST_TARGET, source = testSources, LIBS = ['pthread'], LIBPATH = libPath, CPPPATH = '.')
testInstallPath = '#' + os.path.join(OUTPUT_DIR, TEST_CONFIG)
environment.Install(testInstallPath, test)

testRunPath = os.path.join(OUTPUT_DIR, TEST_CONFIG, TEST_TARGET)
if environment['PLATFORM'] != 'posix':
	testRunPath += '.exe'
	
testRun = environment.Command(target = 'testRun', source = testSources, action = testRunPath)
AlwaysBuild(testRun)
